/*!
 * Copyright (C) 2005 - 2023 TIBCO Software Inc. All rights reserved.
 * http://www.jaspersoft.com.
 *
 * Unless you have purchased a commercial license agreement from Jaspersoft,
 * the following license terms apply:
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */

/* ===========================================
   INPUT STYLES
   Last modified date:    Feb 1, 2023
   Last modified by:      Anna Leeg
 * =========================================== */

// --------------------------------
//   GROUPING MECHANISM FOR INPUTS
// --------------------------------
@use "sass:math";

.jv-mInputgroup.jr .jv-mInput-editable.jr,
.jv-mInputgroup.jr .jv-mInput-selectt.jr  {
  margin-bottom: em(18px, 13px);
}

.jv-mInputgroup.jr .jv-mInput-select.jr {
  margin-bottom: em(20px, 13px);
}

.jv-mInputpair.jr {
  // use to contain two of the same input types when the operator is "between" or "is not between"
}

.jv-mInputpair-text.jr {
  height: em(28px);
  top: em(-4px);
  text-align: center;
  line-height: math.div(28px, 11px);
}

// ---------------------
//   BASE INPUT MODULE
// --------------------
.jv-mInput.jr {
  font-family: $font-family-primary;
  font-size: 13px;
  font-weight: normal;
}

.jv-mInput-label.jr {
  @include input-label;
  font-family: $font-family-semibold;
  font-size: 1em;
}

// label variations
.jv-mInput-labelLight.jr {
  color: $grey-textLightest;
}

.jv-mInput-labelRequired.jr::after {
  color: $color-tciMedium;
  content: " *";
}

.jv-mInput-hint.jr {
  color: $grey-textLightest;
  display: inline-block;
  font-size: em(12px, 13px);
  font-style: italic;
  font-weight: normal;
  line-height: math.div(15px, 13px);
  // line-height and display are here so this element can be inline or block
}

.jv-mInput-alert.jr {
  // TODO remove this rule after resolving JRS-12101 AND after replacing in embeddable input controls
  // JRS-12101 has been resolved; embeddable input controls has not.
  color: $color-errorDark;
  display: block;
  font-weight: bold;
  line-height: math.div(16px, 13px);
  margin-bottom: em(4px, 13px); /* added back in for JRS-15714 */
  margin-top: em(2px, 13px); /* added back in for JRS-15714 */
}

// validation done automatically on save
.jv-mInput-validation.jr {
  line-height: math.div(14px, 11px);
}

.jv-mInput-validation.jr { // NEW
  align-items: flex-start;
  align-content: stretch;
  display: flex;
  flex-wrap: nowrap;
  justify-content: flex-start;
  margin-bottom: em(6px, 13px);
  margin-top: em(4px, 13px);
}

.jv-mInput-validation-message.jr { // NEW, holds validation component
  flex: 1 1 auto;
  margin-top: em(3px, 13px);
}

.jv-mInput-validation-button.jr { // NEW
  flex: 0 0 auto;
  margin-bottom: 2em;
  margin-top: em(3px, 13px);
}

.jv-mInput-validation-message.jr:first-child { // NEW
  //display: inline-flex; flex seems to work just fine
  display: flex;
  justify-content: flex-end;
  padding-right: em(8px, 13px);
}

.jv-mInput-validation-message.jr:only-child { // NEW
  // this rule must come after first-child rule (immediately above)
  justify-content: flex-start;
  margin-top: 0;
}

.jv-mInput-validation-button.jr:first-child { // NEW
  padding-right: em(8px, 13px);
}

.jv-mInput-validation-alert.jr { // TODO remove this rule after resolving JRS-12101
  display: table-row;
  min-height: em(20px, 13px);
  white-space: nowrap;
}

.jv-mInput-validation-alert-text.jr { // TODO remove this rule after resolving JRS-12101
  display: table-cell;
  font-family: $font-family-semibold;
  font-size: 12px; // new base font size
  line-height: math.div(16px, 12px);
  padding-top: 0;
  white-space: normal;
}

.jv-mInput-validation-alert-icon.jr { // TODO remove this rule after resolving JRS-12101
  color: inherit !important;
  display: table-cell;
  line-height: 1.2 !important;
  vertical-align: top !important;
  width: em(20px, 13px);
}

// validation done manually with associated button
.jv-mInput-validationManual.jr { // TODO remove this rule after resolving JRS-12101
  display: table;
  margin-bottom: 2em;
  margin-top: em(7px, 13px);
  width: 100%;
}

.jv-mInput-validationManual.jr .jv-mInput-validation-button.jr { // TODO remove this rule after resolving JRS-12101
  display: table-cell;
  vertical-align: top;
}

.jv-mInput-validationManual.jr .jv-mInput-validation-alert.jr { // TODO remove this rule after resolving JRS-12101
  display: table-cell;
  vertical-align: middle;
  width: 100%;
}

// validation types
.jv-mInput-validation-alertError.jr {color: $color-errorMedium;}      // TODO remove this rule after resolving JRS-12101
.jv-mInput-validation-alertSuccess.jr {color: $color-successDark;}    // TODO remove this rule after resolving JRS-12101
.jv-mInput-validation-alertWarning.jr {color: $color-warningMedium;}  // TODO remove this rule after resolving JRS-12101


// the following relate to which side the button is on (left or right)
.jv-mInput-validationManual.jr .jv-mInput-validation-button.jr:first-child,
.jv-mInput-validationManual.jr .jv-mInput-validation-alert.jr:first-child { // TODO remove this rule after resolving JRS-12101
  padding-right: em(8px, 13px);
}


// ----------------------------
//  MODULE VARIATION - INLINE
// ----------------------------
/* INITIAL TEST
.jv-mInputInline.jr {
  display: table;
}

.jv-mInputInline.jr .jv-mInput-label.jr {
  display: table-cell;
  padding-right: 1em;
}

.jv-mInputInline.jr .jv-mInput-text.jr {
  display: table-cell;
} */



// -------------------------------------------
//  MODULE VARIATION - COMPACT (auto width)
// -------------------------------------------
.jv-mInputCompact.jr {
  display: inline-block;
}

/* INITIAL TEST
.jv-mInputCompact.jr .jv-mInput-text.jr,
.jv-mInputCompact.jr .jv-mInput-number.jr,
.jv-mInputCompact.jr .jv-mInput-email.jr,
.jv-mInputCompact.jr .jv-mInput-password.jr,
.jv-mInputCompact.jr .jv-mInput-search.jr {
  width: auto;
} */


// ---------------------
//  INPUT MODULE TYPES
// ---------------------

// SEARCH
.jv-mInput-searchContainer.jr {} //no rules, but container is needed for correct positioning of clear search icon

.jv-mInput-search.jr {
  background-color: #fff;
  // TODO remove following styles after JRS-14408 is fixed
  //background-image: image-url("icontrol_icons_sprite.png");
  //background-repeat: no-repeat;
  //background-attachment: scroll;
  //background-position: right -269px;
  color: $grey-textDarker;
  display: inline-block;
  overflow: hidden;
  padding-right: em(32px, 13px);
  position: relative;
}

// TODO remove this rule after search input is fixed in multi- and single-select components
.jv-mInput-search.jr:only-child {
  background-image: image-url("icontrol_icons_sprite.svg");
  background-repeat: no-repeat;
  background-attachment: scroll;
  background-position: right -89px;
  background-size: 20px;
}

.jv-mInput-searchPlaceholder.jr {
  // fixes issue (in multiselect) where placeholder text changes color after losing focus
  // add this class name dynamically once input loses focus
  // NOT IMPLEMENTED YET
  color: $grey-textLightest;
}

.jv-mInput-search-trigger.jr {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  width: em(32px, 13px);
}

.jv-mInput-search-clear.jr {
  display: none;
  position: absolute;
  top: 0;
  right: em(30px, 13px);
  bottom: 0;
  width: em(24px, 13px);
}

// TODO remove this rule after JRS-14408 is fixed
.jv-mInput-search-clear-icon.jr {
  background-color: #fff;
  background-image: image-url("icontrol_icons_sprite.png");
  background-repeat: no-repeat;
  background-attachment: scroll;
  background-position: 6px -174px;
  display: inline-block;
  height: 100%;
  width: 100%;
}

// TEXT-BASED
.jv-mInput-date.jr,
.jv-mInput-email.jr,
.jv-mInput-number.jr,
.jv-mInput-password.jr,
.jv-mInput-text.jr,
.jv-mInput-search.jr {
  height: em(28px, 13px);
  width: 100%;
}

.jv-mInput-date.jr:focus,
.jv-mInput-email.jr:focus,
.jv-mInput-number.jr:focus,
.jv-mInput-password.jr:focus,
.jv-mInput-text.jr:focus,
.jv-mInput-textarea.jr:focus,
.jv-mInput-search.jr:focus {
  outline-offset: -2px;
}


// text input with associated button
.jv-mInput-action.jr {
  display: table;
  width: 100%;
}

.jv-mInput-action-text.jr {
  display: table-cell;
  padding-right: em(8px, 13px);
  width: 100%;
}

.jv-mInput-action-button.jr  {
  display: table-cell;
  vertical-align: top;
  white-space: nowrap;
}

.jv-mInput-action-button.jr ~ .jv-mInput-action-button.jr {
  margin-right: em(6px, 13px);
}

// TEXTAREA
.jv-mInput-textarea.jr {
  height: em(70px, 13px);
  resize: vertical;
  white-space: pre-wrap;
  width: 100%;
}

// DATE TIME
.jv-mInput-date.jr {
  width: calc(100% - 3em);
  white-space: normal;
}

.jv-mInput-datetrigger.jr {
  height: em(28px, 13px); // same height as input
  width: em(28px, 13px);
}

.jv-mInput-datetrigger-icon.jr {
  height: 100%;
}

// SELECT (NATIVE)
.jv-mInput-select.jr {
  // top margin ensures that a select input and its label has the same height as other inputs
  // since the select input is shorter than other inputs, extra space is needed for this effect
  margin-top: em(4px, 13px);
  width: auto;
}

.jv-mInput-selectTight.jr {
  // reduces the amount of space between the label and input to match that of other inputs.
  // results in the input and its label not being the same height as other inputs+labels
  margin-top: 0;
}

.jv-mInput-select-item.jr {}

.jv-mInput-select.jr +  .jv-mInput-alert.jr {
  margin-top: em(6px, 13px);
}

.jv-mInput-selectWide.jr {
  width: 100%;
}

// SELECTT (CUSTOM)
.jv-mInput-selectt.jr {
  background-color: #fff;
  display: inline-block;
  position: relative;
}

.jv-mInput-selectt-list.jr {
  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background-color: transparent;
  border: 1px solid #cccccc;
  border-radius: 0;
  display: inline-block;
  line-height: em(26px, 13px);
  height: em(28px, 13px);
  padding-right: em(22px, 13px);
  padding-left: em(5px, 13px);
  position: relative;
  min-width: 50%;
  z-index: $zindex-element-lvl-1; // must be above jv-mInput-selectt-list to show options on click
}

.jv-mInput-selecttWide.jr,
.jv-mInput-selecttWide.jr .jv-mInput-selectt-list.jr {
  width: 100%;
}

.jv-mInput-selectt-list.jr::-ms-expand {
  display: none;
}

.jv-mInput-selectt-list-item.jr {
  padding: em(5px, 13px);
}

.jv-mInput-selectt-expander.jr {
  border: 1px solid #cccccc;
  padding-top: em(2px, 13px);
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: $zindex-element-lvl-0; // must be below jv-mInput-selectt-expander to show options on click
}

// FILE UPLOAD
.jv-mInput-file.jr {
  display: flex;
  position: relative;
  width: 100%;
  height: em(28px, 13px);
}

.jv-mInput-file-input.jr {
  cursor: pointer;
  height: 100%;
  opacity: 0;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 10;
}

.jv-mInput-file-trigger.jr {
  cursor: pointer;
  height: inherit;
}

.jv-mInput-file-name.jr {
  background: #fff;
  border: 1px solid #cccccc;
  height: inherit;
  overflow: hidden;
  white-space: nowrap;
  width: 100%;
}
// placement options for trigger and file name
.jv-mInput-file-trigger.jr ~ .jv-mInput-file-name.jr {
  margin-left: em(8px, 13px);
}

.jv-mInput-file-name.jr ~ .jv-mInput-file-trigger.jr {
  margin-left: em(8px, 13px);
}

.jv-mInput-file-name-label.jr,
.jv-mInput-file-name-placeholder.jr {
  line-height: em(28px, 13px);
  overflow: hidden;
  padding-left: em(6px, 13px);
  padding-right: em(6px, 13px);
  text-overflow: ellipsis;
}

.jv-mInput-file-name-label.jr {
  display: block;
}

.jv-mInput-file-name-placeholder.jr {
  display: none;
}

// small variation
.jv-mInput-fileSmall.jr {
  height: em(22px, 13px);
}

.jv-mInput-fileSmall.jr .jv-mInput-file-name-label.jr,
.jv-mInput-fileSmall.jr .jv-mInput-file-name-placeholder.jr {
  font-size: em(12px, 13px);
  line-height: em(22px, 13px);
}


// TEXT, INLINE EDITABLE
.jv-mInput-editable.jr {}

.jv-mInput-editable-text.jr {
  display: inline-block;
  height: em(26px, 13px);
  line-height: math.div(30px, 13px);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 100%;
}

.jv-mInput-editable-textBlank.jr {
  font-style: italic;
}

.jv-mInput-editable-textArea.jr {
  display: inline-block;
  height: auto;
  line-height: math.div(16px, 13px);
  margin-top: em(7px, 13px);
  max-width: 100%;
  min-height: em(57px, 13px);
  text-overflow: clip;
  white-space: normal;
}

.jv-mInput-editable.jr ~ .jv-mInput-text,
.jv-mInput-editable.jr ~ .jv-mInput-textarea,
.jv-mInput-editableEdit.jr {
  display: none;
}

.jv-mInput-editable-textArea.jr ~ .jv-mInput-editable-indicator.jr {
  cursor: pointer;
  width: em(22px, 13px);
}

.jv-mInput-editable-indicator.jr {
  background-color: inherit;
  display: none;
  margin-top: em(5px, 13px);
  vertical-align: top;
  width: em(32px, 13px);
}

.jv-mInput-editable-indicator.jr .jv-mIcon.jr {
  float: right;
  opacity: .5;
}

// RADIO AND CHECKBOXES
// container for radio buttons and checkboxes when the number of items is more than three
.jv-mInput-set.jr {
  background-color: #fff;
  border: 1px solid #d6d6d6;
  height: em(72px, 13px);
  overflow-y: scroll;
  width: auto;
}

.jv-mInput-checkContainer.jr,
.jv-mInput-radioContainer.jr {
  margin-left: em(5px, 13px);
  margin-top: em(4px, 13px);
  overflow-x: hidden;
  overflow-y: auto;
  position: relative;
}

.jv-mInput-check.jr,
.jv-mInput-radio.jr   {
  margin-left: em(1px, 13px);  // prevents clipping in Chrome
  padding-bottom: em(7px, 13px);
  position: relative;
  white-space: nowrap;
}

.jv-mInput-check-box.jr,
.jv-mInput-radio-button.jr,
.jv-mInput-boolean-box.jr {
  display: inline-block;
  //line-height: em(20px, 13px);
  margin-right: em(2px, 13px);
  height: em(14px, 13px);
  width: em(14px, 13px);
}

.jv-mInput-boolean-box.jr {
  //margin-top: em(3px, 13px);
}

.jv-mInput-check-label.jr,
.jv-mInput-radio-label.jr,
.jv-mInput-boolean-label.jr  {
  color: $grey-textMedium;
  cursor: default;
  display: inline-block;
  vertical-align: top;
  line-height: math.div(17px, 13px); // unitless value
  width: calc(100% - 3em);
}

.jv-mInput-checklabel.jr,
.jv-mInput-radiolabel.jr {
  width: 100%;
}

.jv-mInput-boolean-label.jr {
  font-family: $font-family-semibold;
  //margin-top: em(3px, 13px);
}


.jv-mInput.jv-isInvalid.jr {}


// START all/none/invert button bar
.jv-mItemselector.jr {
  display: table;
  font-size: em(12px, 13px);
  height: em(22px, 12px);
  position: relative;
  table-layout: fixed;
  text-decoration: none;
  width: 100%;
}

.jv-mInput-buttonContainer.jr {
  border: 1px solid #d6d6d6;
  border-top: none;
  position: relative;
  width: 100%;
}

.jv-mItemselector-button.jr {
  background-color: #fff;
  border-right: 1px solid #d6d6d6;
  color: $grey-textMedium;
  cursor: pointer;
  display: table-cell;
  height: 100%;
  line-height: math.div(20px, 12px); // unitless value
  margin: 0;
  overflow: hidden;
  padding: 0 em(4px, 12px);
  text-align: center;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.jv-mItemselector-button-icon.jr {
  width: em(16px, 12px);
}

// IE11
@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
  .jv-mItemselector-button-icon.jr {
    top: 1px;
  }
}

.jv-mItemselector-button-label.jr {
  line-height: math.div(24px, 12px); // unitless value
  overflow: hidden;
  text-decoration: none;
  text-overflow: ellipsis;
  vertical-align: top;
  white-space: nowrap;
}

.jv-mItemselector-button.jr:last-of-type {
  border-right: none;
}



// --------------
//    STATES
// --------------

@media screen and (-webkit-min-device-pixel-ratio:0) {
  .jv-mInput-select.jr:focus,
  .jv-mInput-selectt-list.jr:focus {
    outline-color: #90bffc;
    outline-style: auto;
    outline-width: 4px;
  }
}

@-moz-document url-prefix() {
  .jv-mInput-select.jr:focus {
    outline: 0;
  }
}

// disable input controls
.jv-mInput.jv-isDisabled.jr {
  @include opacity(0.4);
}

.jv-mInput.jv-isDisabled.jr .jv-mInput-datetrigger.jr {
  cursor: default;
}

.jv-mInput.jv-isDisabled.jr * {
  cursor: default;
}

.jv-mInput-text.jr:disabled,
.jv-mInput-textarea.jr:disabled,
.jv-mInput-number.jr:disabled,
.jv-mInput-email.jr:disabled,
.jv-mInput-date.jr:disabled,
.jv-mInput-password.jr:disabled,
.jv-mInput-search.jr:disabled {
  background-color: #f7f7f7;
}

.jv-mInput-text.jv-isDisabled.jr:disabled,
.jv-mInput-textarea.jv-isDisabled.jr:disabled,
.jv-mInput-number.jv-isDisabled.jr:disabled,
.jv-mInput-email.jv-isDisabled.jr:disabled,
.jv-mInput-date.jv-isDisabled.jr:disabled,
.jv-mInput-password.jv-isDisabled.jr:disabled,
.jv-mInput-search.jv-isDisabled.jr:disabled {
  color: #bbbbbb;
}


// editable text hover + click
.jv-mInput-editableStatic.jv-isHovered.jr .jv-mInput-editable-text {
  max-width: calc(100% - 38px) !important;
  text-overflow: clip;
}

.jv-mInput-editableStatic.jv-isHovered.jr .jv-mInput-editable-indicator.jr {
  display: inline-block;
}

.jv-mInput-editableStatic.jv-isClicked.jr {
  display: none;
}

.jv-mInput-editableStatic.jv-isClicked.jr ~ .jv-mInput-editableEdit {
  display: block;
}

// hide file input placeholder text
.jv-mInput-file-name-placeholder.jv-isHidden.jr {
  display: none;
}

// error validation for editable text and textarea
.jv-mInput-editableEdit.jv-isInvalid.jr .jv-mInput-text.jr,
.jv-mInput-editableEdit.jv-isInvalid.jr .jv-mInput-textarea.jr {
  border: 1px solid $color-errorMedium;
  padding-right: em(30px);
}

// hide validation error message
.jv-mInput-alert.jv-isInvisible.jr {
  visibility: hidden;
}

// hide validation error message
.jv-mInput-search-clear.jv-isVisible.jr {
  display: block;
}


// file browse placeholder text
.jv-mInput-file.jv-isEmpty.jr .jv-mInput-file-name-label.jr {
  display: none;
}

.jv-mInput-file.jv-isEmpty.jr .jv-mInput-file-name-placeholder.jr {
  display: block;
  opacity: .3;
}


//:TODO: SMACC violation, fix it
.jv-mSingleselect-input-placeholder.jv-isHidden.jr {
  display: none;
}
